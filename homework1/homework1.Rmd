---
title: "VE414 Homework1"
author: "Liu Yihao 515370910207"
date: "2019-05-28"
output: 
  pdf_document:
    includes:
      in_header: header.tex
    latex_engine: xelatex
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Question1

### (a)
Let $A$ be the event that the lower face of the coin is a head,
$$\Pr(A)=\frac{2\cdot2+2}{2\cdot5}=\frac{3}{5}.$$

### (b)
Let $A$ be the event that the lower face of the coin is a head, $B$ be the event that the coin is showing heads,
<!-- $$\Pr(A\mid B)=\frac{\Pr(B\mid A)\Pr(A)}{\Pr(B)}=\frac{2/4\cdot0.6}{0.6}=0.5.$$ -->
$$\Pr(A\mid B)=\frac{2\cdot2}{2\cdot2+2}=\frac{2}{3}.$$

### (c)
Let $A$ be the event that the lower face of the coin is a head,
$$\Pr(A\mid B)=\frac{4\cdot2}{4\cdot2+2}=\frac{4}{5}.$$

## Question2

The prior distribution of Beta(4,4) is 
$$f_{prior}(p)=\frac{(4+4-1)!}{(4-1)!(4-1)!}p^3(1-p)^3=420p^3(1-p)^3.$$
If $X$ denotes the number of heads out of 10 number of tosses, with the assumption of independence, then
$$X\sim \text{Binomial}(10,p),$$
$$\Pr(X)=\binom{10}{x}p^x(1-p)^{10-x},$$
$$\Pr(X<3)=\sum_{i=0}^2\binom{10}{i}p^i(1-p)^{10-i}=(1-p)^{10}+10p(1-p)^9+45p^2(1-p)^8.$$
The posterior distribution is then
$$f_{post}(p)\propto \Pr(X<3)\cdot f_{prior}=p^3(1-p)^{13}+10p^4(1-p)^{12}+45p^5(1-p)^{11}.$$

```{r ex2}
func <- function(x) {x^3*(1-x)^13+10*x^4*(1-x)^12+45*x^5*(1-x)^11}
curve(func, from = 0, to = 1, xlab = 'p', ylab = 'posterior density for p')
```

## Question3

We use 95% confidence interval.

For the first test,

```{r ex3.1}
func <- function(x) {
  x ^ 40 * (1 - x) ^ 10
}
l <- qbeta(0.025, 41, 11)
r <- qbeta(0.975, 41, 11)
curve(
  func,
  from = 0,
  to = 1,
  xlab = 'p',
  ylab = 'posterior density for p'
)
points(l, func(l))
points(r, func(r))
lines(c(l, l), c(0, func(l)), lty = 2)
lines(c(r, r), c(0, func(r)), lty = 2)
text(l, 0, round(l, 3))
text(r, 0, round(r, 3))
```

Since $p=0.5$ is not in the central credible interval, the data is biased.

For the second test,

```{r ex3.2}
func <- function(x) {
  x ^ 15 * (1 - x) ^ 35
}
l <- qbeta(0.025, 16, 36)
r <- qbeta(0.975, 16, 36)
curve(
  func,
  from = 0,
  to = 1,
  xlab = 'p',
  ylab = 'posterior density for p'
)
points(l, func(l))
points(r, func(r))
lines(c(l, l), c(0, func(l)), lty = 2)
lines(c(r, r), c(0, func(r)), lty = 2)
text(l, 0, round(l, 3))
text(r, 0, round(r, 3))
```

Since $p=0.5$ is not in the central credible interval, the data is biased.

## Question4

### (a)

We define the likelihood function $L$ by
$$L(p)=\prod_{i=1}^n p(1-p)^{x_i-1},$$
$$\ln L(p)=n\ln p+\sum_{i=1}^n(x_i-1)\ln(1-p).$$
Maximizing $\ln L(p)$ will also maximize $L(p)$, so we take the first derivative
and set it equal to zero:
$$\frac{d\ln L(p)}{dp}=\frac{n}{p}-\frac{1}{1-p}\sum_{i=1}^n(x_i-1)=0,$$
$$n(1-p)-p\sum_{i=1}^n(x_i-1)=0,$$
$$n-p\sum_{i=1}^nx_i=0,$$
$$p=\frac{1}{\bar{x}}.$$

